# 布林带策略测试程序使用说明

## 功能特性

- 🚀 实时布林带策略测试
- 📊 完整的日志记录（控制台 + 文件）
- 🔄 WebSocket实时数据接收
- ⚡ 自动交易信号生成
- 📈 性能监控和统计
- 🎯 后台运行支持

## 快速开始

### 1. 启动程序

```bash
# 在后台启动程序
./start_bollinger_test.sh

# 或者直接运行（前台）
cargo run --bin bollinger_test
```

### 2. 查看状态

```bash
# 检查程序运行状态
./status_bollinger_test.sh
```

### 3. 查看实时日志

```bash
# 查看最新的日志文件
tail -f logs/bollinger_test_*.log

# 或者查看特定日期的日志
tail -f logs/bollinger_test_20241201_143000.log
```

### 4. 停止程序

```bash
# 优雅停止程序
./stop_bollinger_test.sh
```

## 日志级别

程序使用以下日志级别：

- **INFO**: 重要事件（启动、停止、交易信号、统计信息）
- **DEBUG**: 详细数据（K线数据、布林带值、处理延迟）
- **WARN**: 警告信息
- **ERROR**: 错误信息

## 日志文件

- **位置**: `logs/` 目录
- **命名**: `bollinger_test_YYYYMMDD_HHMMSS.log`
- **轮转**: 每天自动创建新文件
- **保留**: 建议定期清理旧日志文件

## 交易信号日志

当策略生成交易信号时，会记录以下信息：

```
⚡ 新交易信号生成:
   时间: 2024-12-01 14:30:00
   价格: 50000.00
   信号: MarketSignal { side: Buy, ... }
   计算延迟: 1.234 ms

🟢 买入信号 - 交易对: BTCUSDT, 数量: 10000.0, 价格: 50000.00
```

## 性能监控

程序会定期输出性能统计：

- 消息处理数量
- 信号生成数量
- 运行时间
- 处理速率
- 延迟统计

## 后台运行

使用 `start_bollinger_test.sh` 脚本可以在后台运行程序：

1. 程序会在后台启动
2. 所有输出重定向到日志文件
3. PID保存在 `logs/bollinger_test.pid`
4. 可以通过 `status_bollinger_test.sh` 查看状态
5. 可以通过 `stop_bollinger_test.sh` 停止程序

## 故障排除

### 程序无法启动
- 检查配置文件是否存在
- 检查网络连接
- 查看错误日志

### 程序意外停止
- 检查系统资源
- 查看错误日志
- 检查网络连接状态

### 日志文件过大
- 定期清理旧日志文件
- 调整日志级别
- 使用日志轮转

## 配置说明

程序使用以下配置：

- **交易对**: BTCUSDT
- **时间间隔**: 1分钟
- **布林带周期**: 20
- **标准差**: 2.0
- **ATR周期**: 20

## 注意事项

1. 确保有足够的磁盘空间存储日志文件
2. 定期检查程序运行状态
3. 监控系统资源使用情况
4. 备份重要的配置和日志文件 